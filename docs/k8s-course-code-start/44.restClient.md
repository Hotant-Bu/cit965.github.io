---
sidebar_label: 44.restClient
sidebar_position: 11
title: 44.restClient
---


### PR #995
> Break up API client into per-resource client and common cod

### PR #1002
> Improve the wait.Poll GoDoc and api

这段代码中定义了一些函数类型以及函数，它们可以在 Go 语言中被用来实现轮询（polling）的机制。

ConditionFunc 是一个函数类型，它返回一个布尔值以及一个错误。这个函数类型主要用于判断某个条件是否满足，如果满足则返回 true，如果不满足则返回 false，如果在检查条件过程中出现错误，则直接返回错误。

Poll 函数会在一个间隔（interval）时间内，不断地执行 ConditionFunc 函数，直到函数返回 true 或出现错误，或者达到了超时时间（timeout）。

WaitFunc 是一个函数类型，它返回一个只读的 struct{} 类型的 channel。这个 channel 在每次应该执行测试时都会接收到一个项目，并在应执行最后一个测试时关闭。

WaitFor 函数会从 WaitFunc 得到一个 channel，然后对该 channel 的每个值以及 channel 关闭时调用一次 ConditionFunc。如果 ConditionFunc 返回错误，循环就会结束并返回该错误；如果 ConditionFunc 返回 true，循环就会结束并返回 nil；如果 channel 关闭时 ConditionFunc 还未返回 true，那么就会返回 ErrWaitTimeout 错误。

poller 函数返回一个 WaitFunc，该函数会向 channel 发送信号，每隔一段时间（interval）发送一次，直到超时（timeout），然后关闭 channel。如果间隔时间非常短，可能在 channel 关闭前都没有收到 tick。如果设定的超时时间为 0，那么这个 channel 将永远不会被关闭。

这种模式通常用于你需要等待某个条件满足，但又不想立即阻塞当前的执行线程的情况。这通常发生在处理 I/O，网络请求或者其他需要等待的操作。